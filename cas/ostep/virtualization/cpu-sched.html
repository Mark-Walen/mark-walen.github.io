<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mark-walen.github.io/cas/ostep/virtualization/cpu-sched.html"><meta property="og:site_name" content="蓝芒小栈"><meta property="og:title" content="第 7 章 进程调度：介绍"><meta property="og:description" content="这一节我们将了解 5 个运行调度规则，两种基本调度策略：优化周转时间的三种调度算法和一种优化响应时间的调度算法。这四种调度算法分别是：FIFO，SJF 和 STCF 与 Round Robin."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-10-22T08:20:59.000Z"><meta property="article:author" content="Mark Walen"><meta property="article:published_time" content="2023-10-10T00:00:00.000Z"><meta property="article:modified_time" content="2023-10-22T08:20:59.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"第 7 章 进程调度：介绍","image":[""],"datePublished":"2023-10-10T00:00:00.000Z","dateModified":"2023-10-22T08:20:59.000Z","author":[{"@type":"Person","name":"Mark Walen","url":"https://mrhope.site"}]}</script><title>第 7 章 进程调度：介绍 | 蓝芒小栈</title><meta name="description" content="这一节我们将了解 5 个运行调度规则，两种基本调度策略：优化周转时间的三种调度算法和一种优化响应时间的调度算法。这四种调度算法分别是：FIFO，SJF 和 STCF 与 Round Robin.">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-00110638.css" as="style"><link rel="stylesheet" href="/assets/style-00110638.css">
    <link rel="modulepreload" href="/assets/app-c46cd0fa.js"><link rel="modulepreload" href="/assets/framework-a8949fcd.js"><link rel="modulepreload" href="/assets/cpu-sched.html-014af3d2.js"><link rel="modulepreload" href="/assets/cpu-sched.html-13d89fa7.js"><link rel="prefetch" href="/assets/index.html-52be2bc7.js" as="script"><link rel="prefetch" href="/assets/intro.html-110dfbe0.js" as="script"><link rel="prefetch" href="/assets/slides.html-3d7f78d2.js" as="script"><link rel="prefetch" href="/assets/index.html-ae961a49.js" as="script"><link rel="prefetch" href="/assets/index.html-bec636d0.js" as="script"><link rel="prefetch" href="/assets/SSH Login Without Password.html-78234fbf.js" as="script"><link rel="prefetch" href="/assets/index.html-5560b479.js" as="script"><link rel="prefetch" href="/assets/intro.html-e50a16a3.js" as="script"><link rel="prefetch" href="/assets/slides.html-00c1275a.js" as="script"><link rel="prefetch" href="/assets/index.html-d7e65c04.js" as="script"><link rel="prefetch" href="/assets/index.html-1203682c.js" as="script"><link rel="prefetch" href="/assets/index.html-6418f277.js" as="script"><link rel="prefetch" href="/assets/memory-system.html-c0ff0ae9.js" as="script"><link rel="prefetch" href="/assets/index.html-c7ac02f6.js" as="script"><link rel="prefetch" href="/assets/index.html-9d02a973.js" as="script"><link rel="prefetch" href="/assets/index.html-7e4affd6.js" as="script"><link rel="prefetch" href="/assets/stm32-learning-process.html-45924157.js" as="script"><link rel="prefetch" href="/assets/index.html-b9d9b3bf.js" as="script"><link rel="prefetch" href="/assets/index.html-c4fee7eb.js" as="script"><link rel="prefetch" href="/assets/linear-table.html-1eca0792.js" as="script"><link rel="prefetch" href="/assets/stack.html-19a980a5.js" as="script"><link rel="prefetch" href="/assets/cpu-api.html-d4c6819c.js" as="script"><link rel="prefetch" href="/assets/cpu-mechanism.html-bce6b315.js" as="script"><link rel="prefetch" href="/assets/cpu-sched-mlfq.html-e7d76b85.js" as="script"><link rel="prefetch" href="/assets/processes.html-c0d21f49.js" as="script"><link rel="prefetch" href="/assets/index.html-d5bbd370.js" as="script"><link rel="prefetch" href="/assets/chapter3.html-3414bf27.js" as="script"><link rel="prefetch" href="/assets/index.html-2f9b6698.js" as="script"><link rel="prefetch" href="/assets/clocks.html-bb97b7bc.js" as="script"><link rel="prefetch" href="/assets/creating_vs_constructing.html-efbe8437.js" as="script"><link rel="prefetch" href="/assets/kernel_configuration.html-c3aab903.js" as="script"><link rel="prefetch" href="/assets/power_management.html-d5bd92ec.js" as="script"><link rel="prefetch" href="/assets/queues.html-813f37be.js" as="script"><link rel="prefetch" href="/assets/tasks.html-cb6f42dc.js" as="script"><link rel="prefetch" href="/assets/thread_synchronization.html-0b7709fa.js" as="script"><link rel="prefetch" href="/assets/404.html-c9453ce8.js" as="script"><link rel="prefetch" href="/assets/index.html-cc59c97c.js" as="script"><link rel="prefetch" href="/assets/index.html-6954887e.js" as="script"><link rel="prefetch" href="/assets/index.html-4d1b423f.js" as="script"><link rel="prefetch" href="/assets/index.html-7da25527.js" as="script"><link rel="prefetch" href="/assets/index.html-3416175f.js" as="script"><link rel="prefetch" href="/assets/index.html-f283441d.js" as="script"><link rel="prefetch" href="/assets/index.html-cda232cf.js" as="script"><link rel="prefetch" href="/assets/index.html-7404ad36.js" as="script"><link rel="prefetch" href="/assets/index.html-680ea4a2.js" as="script"><link rel="prefetch" href="/assets/index.html-cd7b1b70.js" as="script"><link rel="prefetch" href="/assets/index.html-6a19bdf4.js" as="script"><link rel="prefetch" href="/assets/index.html-e38bae10.js" as="script"><link rel="prefetch" href="/assets/index.html-eb0160fa.js" as="script"><link rel="prefetch" href="/assets/index.html-d26fe8d5.js" as="script"><link rel="prefetch" href="/assets/index.html-44427bd0.js" as="script"><link rel="prefetch" href="/assets/index.html-58e8eb89.js" as="script"><link rel="prefetch" href="/assets/intro.html-cec7573a.js" as="script"><link rel="prefetch" href="/assets/slides.html-0950f996.js" as="script"><link rel="prefetch" href="/assets/index.html-53471c9b.js" as="script"><link rel="prefetch" href="/assets/index.html-bc1118f0.js" as="script"><link rel="prefetch" href="/assets/SSH Login Without Password.html-62963e46.js" as="script"><link rel="prefetch" href="/assets/index.html-30e4df8d.js" as="script"><link rel="prefetch" href="/assets/intro.html-972a0c2d.js" as="script"><link rel="prefetch" href="/assets/slides.html-8f336cd7.js" as="script"><link rel="prefetch" href="/assets/index.html-02dc61e4.js" as="script"><link rel="prefetch" href="/assets/index.html-735be369.js" as="script"><link rel="prefetch" href="/assets/index.html-79a45f0d.js" as="script"><link rel="prefetch" href="/assets/memory-system.html-7c25e04f.js" as="script"><link rel="prefetch" href="/assets/index.html-dc6304b5.js" as="script"><link rel="prefetch" href="/assets/index.html-e12038e8.js" as="script"><link rel="prefetch" href="/assets/index.html-3ca3e050.js" as="script"><link rel="prefetch" href="/assets/stm32-learning-process.html-908dcbf7.js" as="script"><link rel="prefetch" href="/assets/index.html-2c5ebce8.js" as="script"><link rel="prefetch" href="/assets/index.html-095c4bb4.js" as="script"><link rel="prefetch" href="/assets/linear-table.html-6bb4fdd0.js" as="script"><link rel="prefetch" href="/assets/stack.html-378ec3b7.js" as="script"><link rel="prefetch" href="/assets/cpu-api.html-38ad1904.js" as="script"><link rel="prefetch" href="/assets/cpu-mechanism.html-ff967d38.js" as="script"><link rel="prefetch" href="/assets/cpu-sched-mlfq.html-1bae55fc.js" as="script"><link rel="prefetch" href="/assets/processes.html-33f4338b.js" as="script"><link rel="prefetch" href="/assets/index.html-d14caa18.js" as="script"><link rel="prefetch" href="/assets/chapter3.html-5eb74430.js" as="script"><link rel="prefetch" href="/assets/index.html-153318a0.js" as="script"><link rel="prefetch" href="/assets/clocks.html-c3af417d.js" as="script"><link rel="prefetch" href="/assets/creating_vs_constructing.html-cfaeb4f4.js" as="script"><link rel="prefetch" href="/assets/kernel_configuration.html-50eb6330.js" as="script"><link rel="prefetch" href="/assets/power_management.html-a760f226.js" as="script"><link rel="prefetch" href="/assets/queues.html-a2b4865f.js" as="script"><link rel="prefetch" href="/assets/tasks.html-bb512acd.js" as="script"><link rel="prefetch" href="/assets/thread_synchronization.html-550c2d6e.js" as="script"><link rel="prefetch" href="/assets/404.html-381d0f89.js" as="script"><link rel="prefetch" href="/assets/index.html-525a573b.js" as="script"><link rel="prefetch" href="/assets/index.html-a6d07128.js" as="script"><link rel="prefetch" href="/assets/index.html-850ed28a.js" as="script"><link rel="prefetch" href="/assets/index.html-6af80aea.js" as="script"><link rel="prefetch" href="/assets/index.html-9fae7471.js" as="script"><link rel="prefetch" href="/assets/index.html-65b9696c.js" as="script"><link rel="prefetch" href="/assets/index.html-f8804bfc.js" as="script"><link rel="prefetch" href="/assets/index.html-21014ea8.js" as="script"><link rel="prefetch" href="/assets/index.html-bacf0a68.js" as="script"><link rel="prefetch" href="/assets/index.html-c3d8770e.js" as="script"><link rel="prefetch" href="/assets/index.html-5532837e.js" as="script"><link rel="prefetch" href="/assets/index.html-ef0c26cf.js" as="script"><link rel="prefetch" href="/assets/index.html-17a004d0.js" as="script"><link rel="prefetch" href="/assets/index.html-91cc4137.js" as="script"><link rel="prefetch" href="/assets/index.html-72a9a5af.js" as="script"><link rel="prefetch" href="/assets/giscus-2f1671b8.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-b03bef79.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-1a7cc87c.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ab04f0b1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-31375106.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-36cd6c3c.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="蓝芒小栈"><!----><span class="site-name hide-in-pad">蓝芒小栈</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="嵌入式系统"><span class="title"><span class="font-icon icon iconfont icon-process" style=""></span>嵌入式系统</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>RTOS</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/embedded-system/rtos/ti-rtos/" class="nav-link" aria-label="TI-RTOS"><span class="font-icon icon iconfont icon-OS" style=""></span>TI-RTOS<!----></a></li><li class="dropdown-subitem"><a href="/embedded-system/rtos/freertos/" class="nav-link" aria-label="Free-RTOS"><span class="font-icon icon iconfont icon-OS" style=""></span>Free-RTOS<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>蓝牙协议栈</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/embedded-system/rtos/ti-rtos/" class="nav-link" aria-label="TI-RTOS"><span class="font-icon icon iconfont icon-OS" style=""></span>TI-RTOS<!----></a></li><li class="dropdown-subitem"><a href="/embedded-system/ble5-stack/" class="nav-link" aria-label="BLE5-Stack"><span class="font-icon icon iconfont icon-bluetooth" style=""></span>BLE5-Stack<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ARM Cortex-M3</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/embedded-system/arm-v7" class="nav-link" aria-label="权威指南"><span class="font-icon icon iconfont icon-OS" style=""></span>权威指南<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="编程基础"><span class="title"><span class="font-icon icon iconfont icon-shell" style=""></span>编程基础</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/program/C/" class="nav-link" aria-label="C 语言"><span class="font-icon icon iconfont icon-c" style=""></span>C 语言<!----></a></li><li class="dropdown-item"><a href="/program/data-structure/" class="nav-link" aria-label="数据结构"><span class="font-icon icon iconfont icon-structure" style=""></span>数据结构<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="计算机专业课"><span class="title"><span class="font-icon icon iconfont icon-computer" style=""></span>计算机专业课</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/cas/ostep/" class="nav-link active" aria-label="操作系统导论"><span class="font-icon icon iconfont icon-OS" style=""></span>操作系统导论<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html" class="router-link-active router-link-exact-active nav-link active" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="dropdown-item"><a href="/en/" class="nav-link" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="nav-item"><a class="repo-link" href="https://github.com/Mark-Walen/blog-vlue-tech" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable active"><!----><a href="/cas/ostep/" class="nav-link active title" aria-label="操作系统导论"><!---->操作系统导论<!----></a><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">虚拟化</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/cas/ostep/virtualization/processes.html" class="nav-link sidebar-link sidebar-page" aria-label="第 4 章 抽象：进程"><!---->第 4 章 抽象：进程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cas/ostep/virtualization/cpu-api.html" class="nav-link sidebar-link sidebar-page" aria-label="第 5 章 插叙： 进程 API"><!---->第 5 章 插叙： 进程 API<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cas/ostep/virtualization/cpu-mechanism.html" class="nav-link sidebar-link sidebar-page" aria-label="第 6 章 机制： 受限制的直接执行"><!---->第 6 章 机制： 受限制的直接执行<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="第 7 章 进程调度：介绍"><!---->第 7 章 进程调度：介绍<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#思维导图" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="思维导图"><!---->思维导图<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#引言" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="引言"><!---->引言<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-1-工作负载假设" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.1 工作负载假设"><!---->7.1 工作负载假设<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-2-调度指标" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.2 调度指标"><!---->7.2 调度指标<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-3-先进先出-fifo" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.3 先进先出（FIFO）"><!---->7.3 先进先出（FIFO）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-4-最短任务优先-sjf" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.4 最短任务优先（SJF）"><!---->7.4 最短任务优先（SJF）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-5-最短完成时间优先-stcf" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.5 最短完成时间优先（STCF）"><!---->7.5 最短完成时间优先（STCF）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-6-新度量指标-响应时间" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.6 新度量指标：响应时间"><!---->7.6 新度量指标：响应时间<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-7-时间片轮转调度" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.7 时间片轮转调度"><!---->7.7 时间片轮转调度<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-8-结合-i-o" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.8 结合 I/O"><!---->7.8 结合 I/O<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-9-no-more-oracle" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.9 No More Oracle"><!---->7.9 No More Oracle<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-10-小结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.10 小结"><!---->7.10 小结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/cas/ostep/virtualization/cpu-sched-mlfq.html" class="nav-link sidebar-link sidebar-page" aria-label="第 8 章 进程调度：多级反馈队列"><!---->第 8 章 进程调度：多级反馈队列<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->第 7 章 进程调度：介绍</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mrhope.site" target="_blank" rel="noopener noreferrer">Mark Walen</a></span><span property="author" content="Mark Walen"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-10-10T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 19 分钟</span><meta property="timeRequired" content="PT19M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#思维导图" class="router-link-active router-link-exact-active toc-link level2">思维导图</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#引言" class="router-link-active router-link-exact-active toc-link level2">引言</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-1-工作负载假设" class="router-link-active router-link-exact-active toc-link level2">7.1 工作负载假设</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-2-调度指标" class="router-link-active router-link-exact-active toc-link level2">7.2 调度指标</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-3-先进先出-fifo" class="router-link-active router-link-exact-active toc-link level2">7.3 先进先出（FIFO）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-4-最短任务优先-sjf" class="router-link-active router-link-exact-active toc-link level2">7.4 最短任务优先（SJF）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-5-最短完成时间优先-stcf" class="router-link-active router-link-exact-active toc-link level2">7.5 最短完成时间优先（STCF）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-6-新度量指标-响应时间" class="router-link-active router-link-exact-active toc-link level2">7.6 新度量指标：响应时间</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-7-时间片轮转调度" class="router-link-active router-link-exact-active toc-link level2">7.7 时间片轮转调度</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-8-结合-i-o" class="router-link-active router-link-exact-active toc-link level2">7.8 结合 I/O</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-9-no-more-oracle" class="router-link-active router-link-exact-active toc-link level2">7.9 No More Oracle</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cas/ostep/virtualization/cpu-sched.html#_7-10-小结" class="router-link-active router-link-exact-active toc-link level2">7.10 小结</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="思维导图" tabindex="-1"><a class="header-anchor" href="#思维导图" aria-hidden="true">#</a> 思维导图</h2><figure><img src="/assets/img/ostep/7.cpu-sched-mindmap.png" alt="cpu sched" tabindex="0" loading="lazy"><figcaption><b>图 7.0 </b>进程调度思维导图</figcaption></figure><h2 id="引言" tabindex="-1"><a class="header-anchor" href="#引言" aria-hidden="true">#</a> 引言</h2><p>到目前为止，关于运行进程的底层机制（例如上下文切换）应该是清楚的；如果不清楚，可以回到前面的章节重新阅读关于这些内容的描述。然而，我们还没有理解操作系统调度程序采用的高级策略。现在我们将做到这一点，介绍一系列调度策略（有时被称为学科），这些策略是各种聪明而勤奋的人多年来开发出来的。</p><p>事实上，调度的起源早于计算机系统；早期的方法来自运营管理领域，应用于计算机。这个事实应该不足为奇：装配线和许多其他人类工作也需要调度，其中存在许多相同的问题，包括对效率的强烈追求。</p><p>因此，我们的问题是：</p><div class="hint-container info"><p class="hint-container-title">关键问题：如何开发调度策略</p><p>我们应该如何开发一个关于调度策略的基本框架？有哪些关键假设？哪些指标是重要的？在最早的计算机系统中使用了哪些基本方法？</p></div><h2 id="_7-1-工作负载假设" tabindex="-1"><a class="header-anchor" href="#_7-1-工作负载假设" aria-hidden="true">#</a> 7.1 工作负载假设</h2><p>在讨论可能的策略范围之前，让我们首先对运行在系统中的进程进行一些简化的假设，有时将它们统称为工作负载。确定工作负载是制定策略的关键部分，而您对工作负载了解得越多，策略就可以更加精细化。</p><p>我们在这里所做的工作负载假设大部分都是不现实的，但这没关系（暂时），因为随着我们的进展，我们将放宽这些假设，并最终开发出我们将称之为...（戏剧性的停顿）...</p><p>完全运行调度规则（a fully-operational scheduling discipline）。</p><p>对在系统中运行的进程（有时称为作业）的做出如下假设：</p><ol><li>每个作业运行相同的时间；</li><li>所有作业在同一时间到达。</li><li>一旦开始，每个作业都运行到完成。</li><li>所有作业只使用 CPU（即，它们不执行 I/O 操作）</li><li>每个作业的运行时间是已知的。</li></ol><p>我们说这些假设中有许多是不现实的，但就像在奥威尔的《动物农场》中一些动物比其他动物更平等一样，本章中有些假设比其他假设更不现实。特别是，您可能会感到困扰的是每个作业的运行时间都是已知的：这将使调度程序无所不知，尽管这将是伟大的（可能），但不太可能在短时间内发生。</p><h2 id="_7-2-调度指标" tabindex="-1"><a class="header-anchor" href="#_7-2-调度指标" aria-hidden="true">#</a> 7.2 调度指标</h2><p>除了做出工作负载假设外，我们还需要一件东西来使我们能够比较不同的调度策略：调度指标。指标只是我们用来衡量某些东西的东西，而在调度中有许多不同的指标是有意义的。然而，暂时让我们简化生活，只使用一个指标：周转时间。作业的周转时间被定义为作业完成的时间减去作业到达系统的时间。更正式地说，周转时间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{turnaround}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">na</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>T</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>−</mo><msub><mi>T</mi><mrow><mi>a</mi><mi>r</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> T_{turnaround} = T_{completion} − T_{arrival} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">na</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>因为我们假设所有作业都在同一时间到达，所以目前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>a</mi><mi>r</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">T_{arrival} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，因此<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{turnaround} = T_{completion}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">na</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。随着我们放宽前述的假设，这个事实将发生改变。</p><p>您应该注意，周转时间是一种性能指标，它将是本章的主要关注点。另一个感兴趣的指标是公平性，可以通过Jain公平性指数[J91]等来衡量。性能和公平性在调度中经常相互矛盾；例如，调度程序可能优化性能，但以阻止一些作业运行为代价，从而降低公平性。这个困境告诉我们，生活并不总是完美的。</p><h2 id="_7-3-先进先出-fifo" tabindex="-1"><a class="header-anchor" href="#_7-3-先进先出-fifo" aria-hidden="true">#</a> 7.3 先进先出（FIFO）</h2><p>我们可以实现的最基本的调度算法之一被称为先进先出（FIFO）调度，有时也称为先来先服务（FCFS）。FIFO 具有许多积极的特性：它显然很简单，因此易于实现。并且，在我们的假设下，它工作得相当不错。</p><p>让我们一起快速举个例子。想象一下，系统中有三个作业，A、B 和 C，它们几乎在同一时间到达（Tarrival = 0）。因为 FIFO 必须首先放置某个作业，让我们假设虽然它们都是同时到达的，A 比 B 稍微早到一点，B 比 C 稍微早到一点。还假设每个作业运行 10 秒。这些作业的平均周转时间将是多少？</p><figure><img src="/assets/img/ostep/7.1.png" alt="FIFO Simple example" tabindex="0" loading="lazy"><figcaption>图 7.1 简单的 FIFO 例子</figcaption></figure><p>从图 7.1 中，您可以看到 A 在 10 时完成，B 在 20 时完成，C 在 30 时完成。因此，这三个作业的平均周转时间简单地是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>10</mn><mo>+</mo><mn>20</mn><mo>+</mo><mn>30</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">\frac{10 + 20 + 30}{3} = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span><span class="mbin mtight">+</span><span class="mord mtight">20</span><span class="mbin mtight">+</span><span class="mord mtight">30</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span>。计算周转时间就是这么简单。</p><p>现在让我们放宽我们的一个假设。特别是，让我们放宽假设 1，因此不再假设每个作业运行的时间相同。FIFO 现在的表现如何？您能构建什么样的工作负载来使 FIFO 的性能变差？</p><p><em>（在阅读以下内容之前，请考虑一下...继续思考...搞清楚了吗？！）</em></p><p>您现在可能已经弄清楚了，但以防万一，让我们再举一个示例，以展示不同长度的作业怎么让 FIFO 调度出现问题。特别是，让我们再次假设有三个作业（A、B 和 C），但这次A运行100 秒，而 B 和 C 各自运行10秒。</p><figure><img src="/assets/img/ostep/7.2.png" alt="Why FIFO Is Not That Great" tabindex="0" loading="lazy"><figcaption>图 7.2 为什么 FIFO 并不那么好</figcaption></figure><p>如您在图 7.2 中所见，作业 A 在 B 或 C 甚至有机会运行之前，首先运行了整整 100 s。因此，系统的平均周转时间很高：110 s（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>100</mn><mo>+</mo><mn>110</mn><mo>+</mo><mn>120</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>110</mn></mrow><annotation encoding="application/x-tex">\frac{100 + 110 + 120}{3} = 110</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">100</span><span class="mbin mtight">+</span><span class="mord mtight">110</span><span class="mbin mtight">+</span><span class="mord mtight">120</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">110</span></span></span></span>）。</p><p>这个问题通常被称为护航效应（convey effect），其中一些相对较短的潜在资源使用者排在一个重量级资源使用者后面。这种调度情景可能让你想起杂货店里的一个排队等待的场景，当你看到前面的人推着三车食品并拿出支票簿时，你知道要等一段时间。</p><p>那么我们该怎么办呢？如何开发一个更好的算法来处理运行时间不同的作业？先自己思考一下，然后再阅读下文。</p><h2 id="_7-4-最短任务优先-sjf" tabindex="-1"><a class="header-anchor" href="#_7-4-最短任务优先-sjf" aria-hidden="true">#</a> 7.4 最短任务优先（SJF）</h2><p>解决这个问题的方法非常简单，事实上是从运筹学[1954 年的参考文献，1956 年的参考文献]中借鉴过来的，应用到了计算机系统中的作业调度。这个新的调度策略被称为“最短作业优先”（Shortest Job First，SJF），这个名字应该很容易记住，因为它完全描述了这个策略：首先运行最短的作业，然后是下一个最短的，以此类推。</p><div class="hint-container tip"><p class="hint-container-title">SJF 调度算法的原则</p><p>SJF 原则表示了一个通用的调度原则，可以应用于任何关心每个客户（或在我们的情况下，作业）的周转时间的系统。想象一下你等过的任何队列：如果相关的机构关心客户满意度，他们很可能已经考虑了 SJF。例如，杂货店通常设有一个“十件或以下”的队伍，以确保只购买少量商品的顾客不会被堵在准备应对未来<a href="https://zh.wikipedia.org/zh-cn/%E6%A0%B8%E5%86%AC%E5%A4%A9" target="_blank" rel="noopener noreferrer">核冬天<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>的家庭后面。</p></div><figure><img src="/assets/img/ostep/7-3.png" alt="image-20231021205801817" tabindex="0" loading="lazy"><figcaption>7.3 简单的 SJF 例子</figcaption></figure><p>让我们继续使用上面的示例，但将 SJF 作为我们的调度策略。图7.3显示了运行 A、B 和 C 的结果。希望这个图表清楚地表明了为什么 SJF 在平均周转时间方面表现得更好。通过在运行 A 之前先运行 B 和 C，SJF 将平均周转时间从 110 秒减少到 50 秒（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>10</mn><mo>+</mo><mn>20</mn><mo>+</mo><mn>120</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\frac{10 + 20 + 120}{3} = 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span><span class="mbin mtight">+</span><span class="mord mtight">20</span><span class="mbin mtight">+</span><span class="mord mtight">120</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50</span></span></span></span>），性能提高了两倍多。</p><p>事实上，根据我们关于所有作业同时到达的假设，我们可以证明 SJF 确实是一种最优的调度算法。然而，您正在上系统课程，而不是理论或运筹学课程；所以在这里就不给出它的证明。</p><p>因此，我们已经找到了一个很好的 SJF 调度方法，但我们的假设仍然相当不现实。让我们放宽一些。具体来说，我们可以针对假设 2，现在假设作业可以在任何时间到达，而不是一次性到达。这会导致什么问题呢？ （再次思考...你在思考吗？）</p><p>在这里，我们可以通过一个示例再次说明问题。这一次，假设 A 在 t = 0 时到达，需要运行100 秒，而 B 和 C 在 t = 10 时到达，每个都需要运行 10 秒。使用纯 SJF，我们将得到图 7.4 中所示的时间表。</p><figure><img src="/assets/img/ostep/7.4.png" alt="SJF Example With Late Arrivals From B and C" tabindex="0" loading="lazy"><figcaption>图 7.4 SJF 例子：晚到的作业 B 和 C</figcaption></figure><p>如图 7.4 所示，尽管 B 和 C 在 A 之后不久到达，但它们仍然被迫等待 A 完成，因此遭受了相同的车队问题。这三个作业的平均周转时间为 103.33 秒（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>100</mn><mo>+</mo><mo stretchy="false">(</mo><mn>110</mn><mo>−</mo><mn>10</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>120</mn><mo>−</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><mn>3</mn></mfrac><mo>=</mo><mn>103.33</mn></mrow><annotation encoding="application/x-tex">\frac{100 +(110-10) + (120-10)}{3} = 103.33</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">100</span><span class="mbin mtight">+</span><span class="mopen mtight">(</span><span class="mord mtight">110</span><span class="mbin mtight">−</span><span class="mord mtight">10</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mopen mtight">(</span><span class="mord mtight">120</span><span class="mbin mtight">−</span><span class="mord mtight">10</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">103.33</span></span></span></span>）。调度程序可以采取什么措施呢？</p><h2 id="_7-5-最短完成时间优先-stcf" tabindex="-1"><a class="header-anchor" href="#_7-5-最短完成时间优先-stcf" aria-hidden="true">#</a> 7.5 最短完成时间优先（STCF）</h2><p>为解决这个问题，我们需要放宽第 3 个假设（即作业必须运行到完成），因此让我们这样做。此外，调度程序本身需要一些机制。如您可能猜到的，考虑到我们之前关于定时器中断和上下文切换的讨论，调度程序可以在 B 和 C 到达时采取其他措施：它可以抢占作业 A，并决定运行另一个作业，或许稍后继续 A。根据我们的定义，SJF 是一个非抢占式调度程序，因此存在上述问题。</p><figure><img src="/assets/img/ostep/7.5.png" alt="STCF Simple Example" tabindex="0" loading="lazy"><figcaption><b>图 7.2</b> 简单的 STCF 例子</figcaption></figure><p>幸运的是，有一个调度程序可以做到这一点：为 SJF 添加抢占功能，即最短剩余运行时间优先（STCF）或抢占式最短作业优先（PSJF）调度程序。每当新作业进入系统时，STCF 调度程序确定剩余作业（包括新作业）中哪个作业剩余时间最少，并安排运行该作业。因此，在我们的示例中，STCF将抢占A并运行B和C直到完成；只有在它们完成后，才会安排A的剩余时间。图7.5显示了一个示例。</p><p>结果是平均周转时间大大提高：50 秒（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mo stretchy="false">(</mo><mn>120</mn><mo>−</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>20</mn><mo>−</mo><mn>10</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>30</mn><mo>−</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{(120−0)+(20−10)+(30−10)}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">120</span><span class="mbin mtight">−</span><span class="mord mtight">0</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mopen mtight">(</span><span class="mord mtight">20</span><span class="mbin mtight">−</span><span class="mord mtight">10</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mopen mtight">(</span><span class="mord mtight">30</span><span class="mbin mtight">−</span><span class="mord mtight">10</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>）。与以前一样，根据我们的新假设，STCF 是可证明的最优的；考虑到如果所有作业同时到达，则 SJF 是最优的，您可能能够理解 STCF 最优性背后的直觉。</p><h2 id="_7-6-新度量指标-响应时间" tabindex="-1"><a class="header-anchor" href="#_7-6-新度量指标-响应时间" aria-hidden="true">#</a> 7.6 新度量指标：响应时间</h2><p>因此，如果我们知道作业的长度，且作业只使用 CPU，而我们唯一的指标是周转时间，那么 STCF 将是一个很好的策略。实际上，对于早期的批处理计算系统，这些类型的调度算法是有道理的。然而，分时共享计算机的引入改变了一切。现在，用户会坐在终端前，要求系统具有交互性能。因此，产生了一个新的度量标准：响应时间。</p><p>我们将响应时间定义为作业到达系统后首次被调度的时间。更正式地说：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>T</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>u</mi><mi>n</mi></mrow></msub><mo>−</mo><msub><mi>T</mi><mrow><mi>a</mi><mi>r</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> T_{response} = T_{firstrun} − T_{arrival} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">res</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">rs</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>例如，如果我们有图7.5的时间表（A 在时间 0 到达，B 和 C 在时间 10 到达），则每个作业的响应时间如下：作业 A 为 0，作业 B 为 0，作业 C 为 10（平均值：3.33）。</p><p>正如你可能想的那样，STCF 和相关的调度方法对于响应时间来说并不特别好。例如，如果有三个作业同时到达，第三个作业必须等待前两个作业完全运行后才能被调度一次。尽管对于周转时间来说效果很好，但这种方法对于响应时间和交互性来说非常不利。想象一下坐在终端前输入内容，由于某个其他作业排在你前面而不得不等待10秒才能看到系统的响应：这并不怎么愉快。</p><p>因此，我们面临另一个问题：如何构建一个对响应时间敏感的调度器？</p><h2 id="_7-7-时间片轮转调度" tabindex="-1"><a class="header-anchor" href="#_7-7-时间片轮转调度" aria-hidden="true">#</a> 7.7 时间片轮转调度</h2><p>为了解决这个问题，我们将引入一种新的调度算法，经典地称为轮转（Round-Robin，简称RR）调度。其基本思想很简单：RR 不是运行作业直到完成，而是为每个作业分配一个时间片（有时被称为调度量子），然后切换到运行队列中的下一个作业。它反复这样做，直到所有作业完成。因此，RR 有时被称为时间片轮转。请注意，时间片的长度必须是计时器中断周期的倍数；因此，如果计时器每 10 毫秒中断一次，时间片可以是 10、20或 10 毫秒的任何倍数。</p><figure><img src="/assets/img/ostep/7.6.png" alt="SJF Again (Bad for Response time)" tabindex="0" loading="lazy"><figcaption><b>图 7.6</b> SJF 的响应时间不怎么好。</figcaption></figure><figure><img src="/assets/img/ostep/7.7.png" alt="Round Robin" tabindex="0" loading="lazy"><figcaption><b>图 7.7 </b> 时间片轮转调度</figcaption></figure><p>为了更详细地了解 RR，让我们看一个例子。假设有三个作业 A、B 和 C 在同一时间到达系统，它们每个都希望运行 5 秒。使用 SJF 调度器会在运行下一个作业之前将每个作业运行到完成（如图 7.6 所示）。相比之下，具有 1 秒时间片的RR会迅速循环运行作业（如图7.7所示）。</p><p>RR的平均响应时间是：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>0</mn><mo>+</mo><mn>1</mn><mo>+</mo><mn>2</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{0+1+2}{3} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>；而 SJF 的平均响应时间是：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>10</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\frac{0+5+10}{3} = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mbin mtight">+</span><span class="mord mtight">5</span><span class="mbin mtight">+</span><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>。</p><p>正如您所看到的，时间片的长度对RR非常重要。它越短，在响应时间指标下 RR 的性能越好。然而，将时间片设得太短会导致问题：突然之间，上下文切换的成本将支配整体性能。因此，决定时间片的长度对系统设计者来说是一个权衡，要让它足够长以摊销切换的成本，但又不要让它太长，以至于系统不再响应。</p><p>请注意，上下文切换的成本不仅仅源于操作系统保存和恢复一些寄存器的操作。当程序运行时，它们会在 CPU 缓存、TLB、分支预测器和其他芯片上的硬件中积累大量状态。切换到另一个作业会导致这些状态被刷新，并且会将与当前运行作业相关的新状态加载进来，这可能会对性能产生明显的成本。</p><p>因此，带有合理时间片的 RR 是一个在响应时间是唯一度量标准的情况下的出色调度器。但是，对于我们的老朋友周转时间呢？让我们再次看看上面的示例。具有 5 秒运行时间的 A、B 和 C 在相同时间到达，RR 是具有（较长）1 秒时间片的调度程序。从上面的图片中，我们可以看到 A 在 13 时结束，B 在 14 时结束，C 在 15 时结束，平均为 14。非常糟糕！</p><p>因此，RR在周转时间是我们的度量标准时的确是最差的策略之一。直观地来看，这是有道理的：RR所做的是尽量延长每个作业的时间，只在移至下一个作业之前运行每个作业一小段时间。因为周转时间只关心作业何时完成，所以 RR 几乎是最差的，甚至在许多情况下比简单的 FIFO 还要糟糕。</p><p>更一般地说，任何公平的策略（如 RR），即在较小的时间尺度上均匀分配 CPU 给活跃进程，都会在周转时间等度量标准上表现不佳。这实际上是一种固有的权衡：如果你愿意不公平对待，你可以运行较短的作业直到完成，但以响应时间为代价；如果你更重视公平性，响应时间会降低，但以周转时间为代价。这种权衡在系统中很常见；你不能既要鱼，又要熊掌。</p><p>我们已经开发了两种类型的调度程序。第一种类型（SJF、STCF）优化周转时间，但在响应时间方面表现不佳。第二种类型（RR）优化响应时间，但在周转时间方面表现不佳。而我们仍然需要舍弃两个假设：假设4（作业不进行 I/O）和假设5（作业的运行时间已知）。</p><h2 id="_7-8-结合-i-o" tabindex="-1"><a class="header-anchor" href="#_7-8-结合-i-o" aria-hidden="true">#</a> 7.8 结合 I/O</h2><p>首先，我们将舍弃第 4 个假设——当然，所有程序都执行 I/O。想象一个不需要任何输入的程序：它每次都会产生相同的输出。再想象一个没有输出的程序：那就像是树在森林中倒下，无人看到；它运行与否都无关紧要。</p><p>当作业发起 I/O 请求时，调度程序显然需要做出决策，因为当前正在运行的作业在 I/O 期间不会使用 CPU；它被阻塞等待 I/O 完成。如果 I/O 被发送到硬盘驱动器，取决于驱动器的当前 I/O 负载情况，该进程可能会被阻塞几毫秒或更长时间。因此，在这个时候，调度程序可能应该在 CPU 上安排另一个作业运行。</p><p>当 I/O 完成时，调度程序还必须做出决策。当发生这种情况时，会引发一个中断，操作系统会运行并将发出 I/O 的进程从阻塞状态移回就绪状态。当然，它甚至可以决定在那时运行该作业。操作系统应该如何处理每个作业？</p><p>为了更好地理解这个问题，让我们假设有两个作业 A 和 B，它们都需要 50 毫秒的 CPU 时间。然而，有一个明显的区别：A 运行了 10 毫秒，然后发出了一个 I/O 请求（在这里假设每个 I/O 需要 10 毫秒），而 B 只是在 CPU 上运行了 50 毫秒，没有进行任何 I/O 操作。调度程序首先运行 A，然后运行 B（见图 7.8）。</p><figure><img src="/assets/img/ostep/7.8.png" alt="Poor Use of Resources" tabindex="0" loading="lazy"><figcaption><b>图 7.8 </b>资源的利用率低</figcaption></figure><p>假设我们正在尝试构建一个 STCF 调度程序。这样的调度程序应该如何处理A被分为5个10毫秒子作业，而 B 只是一个需要 50 毫秒 CPU 时间的作业？很明显，仅仅按顺序运行一个作业，然后再运行另一个作业，而不考虑如何处理 I/O 是没有意义的。</p><p>一种常见的方法是将 A 的每个 10 毫秒子作业视为独立的作业。因此，当系统启动时，它可以选择是调度一个 10 毫秒的 A 还是一个 50 毫秒的 B。对于 STCF，选择是明显的：选择较短的那一个，即 A。然后，当 A 的第一个子作业完成时，只剩下 B，它开始运行。然后提交一个新的 A 子作业，它会抢占 B 并运行 10 毫秒。这样可以实现重叠，即在等待另一个进程的 I/O 完成时，CPU 被另一个进程使用；因此，系统被更好地利用（见图 7.9）。</p><figure><img src="/assets/img/ostep/7.9.png" alt="Overlap Allows Better Use of Resources" tabindex="0" loading="lazy"><figcaption><b>图 7.9 </b>重叠可以让资源更好地得到利用</figcaption></figure><p>因此，我们可以看到调度程序如何处理 I/O。通过将每个 CPU 突发作为一个作业处理，调度程序确保“交互式”的进程频繁运行。当这些交互式作业执行 I/O 操作时，其他 CPU 密集型作业会运行，从而更好地利用处理器。</p><div class="hint-container tip"><p class="hint-container-title">重叠操作可以提高利用率。</p><p>当可能的时候，重叠操作以最大化系统的利用。重叠在许多不同领域都很有用，包括在执行磁盘 I/O 或发送消息给远程机器时；在这两种情况下，启动操作然后切换到其他工作是一个好主意，可以提高系统的整体利用率和效率。</p></div><h2 id="_7-9-no-more-oracle" tabindex="-1"><a class="header-anchor" href="#_7-9-no-more-oracle" aria-hidden="true">#</a> 7.9 No More Oracle</h2><p>有了基本的 I/O 方法，我们来到了最后一个假设：调度程序知道每个作业的长度。正如我们之前所说，这可能是我们能够做出的最糟糕的假设。事实上，在通用操作系统（我们关心的那种）中，操作系统通常对每个作业的长度知之甚少。那么，如何构建一个行为类似 SJF/STCF 的方法，而不需要这样的先验知识？此外，如何结合我们在 RR 调度程序中看到的一些想法，使响应时间也非常好？</p><h2 id="_7-10-小结" tabindex="-1"><a class="header-anchor" href="#_7-10-小结" aria-hidden="true">#</a> 7.10 小结</h2><p>我们已经介绍了调度背后的基本思想，并开发了两类调度策略。第一类策略运行剩余时间最短的作业，从而优化周转时间；第二类策略在所有作业之间交替，从而优化响应时间。在一个领域表现良好的地方，它们在另一个领域表现不佳，这是系统中常见的固有权衡。我们还看到了如何将 I/O 纳入考虑，但仍然没有解决操作系统无法预测未来的基本问题。不久以后，我们将看到如何克服这个问题，通过构建一个调度程序，利用最近的过去来预测未来。这个调度程序被称为多级反馈队列，它是下一章的主题。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/Mark-Walen/blog-vlue-tech/edit/dev_0.0/docs/cas/ostep/virtualization/cpu-sched.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: mark_walen@qq.com">Mark-Walen</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/cas/ostep/virtualization/cpu-mechanism.html" class="nav-link prev" aria-label="第 6 章 机制： 受限制的直接执行"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->第 6 章 机制： 受限制的直接执行</div></a><a href="/cas/ostep/virtualization/cpu-sched-mlfq.html" class="nav-link next" aria-label="第 8 章 进程调度：多级反馈队列"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">第 8 章 进程调度：多级反馈队列<!----></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">默认页脚</div><div class="copyright">Copyright © 2023 Mark Walen</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-c46cd0fa.js" defer></script>
  </body>
</html>
