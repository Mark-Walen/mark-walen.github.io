import{_ as n,X as m,Y as i,Z as s,$ as a,a1 as e,a2 as l,E as r}from"./framework-a8949fcd.js";const p="/assets/img/ostep/7.1.png",c="/assets/img/ostep/7.2.png",h="/assets/img/ostep/7-3.png",o="/assets/img/ostep/7.4.png",g="/assets/img/ostep/7.5.png",u={},d=l('<h2 id="思维导图" tabindex="-1"><a class="header-anchor" href="#思维导图" aria-hidden="true">#</a> 思维导图</h2><h2 id="引言" tabindex="-1"><a class="header-anchor" href="#引言" aria-hidden="true">#</a> 引言</h2><p>到目前为止，关于运行进程的底层机制（例如上下文切换）应该是清楚的；如果不清楚，可以回到前面的章节重新阅读关于这些内容的描述。然而，我们还没有理解操作系统调度程序采用的高级策略。现在我们将做到这一点，介绍一系列调度策略（有时被称为学科），这些策略是各种聪明而勤奋的人多年来开发出来的。</p><p>事实上，调度的起源早于计算机系统；早期的方法来自运营管理领域，应用于计算机。这个事实应该不足为奇：装配线和许多其他人类工作也需要调度，其中存在许多相同的问题，包括对效率的强烈追求。</p><p>因此，我们的问题是：</p><div class="hint-container info"><p class="hint-container-title">关键问题：如何开发调度策略</p><p>我们应该如何开发一个关于调度策略的基本框架？有哪些关键假设？哪些指标是重要的？在最早的计算机系统中使用了哪些基本方法？</p></div><h2 id="_7-1-工作负载假设" tabindex="-1"><a class="header-anchor" href="#_7-1-工作负载假设" aria-hidden="true">#</a> 7.1 工作负载假设</h2><p>在讨论可能的策略范围之前，让我们首先对运行在系统中的进程进行一些简化的假设，有时将它们统称为工作负载。确定工作负载是制定策略的关键部分，而您对工作负载了解得越多，策略就可以更加精细化。</p><p>我们在这里所做的工作负载假设大部分都是不现实的，但这没关系（暂时），因为随着我们的进展，我们将放宽这些假设，并最终开发出我们将称之为...（戏剧性的停顿）...</p><p>完全运行调度规则（a fully-operational scheduling discipline）。</p><p>对在系统中运行的进程（有时称为作业）的做出如下假设：</p><ol><li>每个作业运行相同的时间；</li><li>所有作业在同一时间到达。</li><li>一旦开始，每个作业都运行到完成。</li><li>所有作业只使用CPU（即，它们不执行I/O操作）</li><li>每个作业的运行时间是已知的。</li></ol><p>我们说这些假设中有许多是不现实的，但就像在奥威尔的《动物农场》[O45]中一些动物比其他动物更平等一样，本章中有些假设比其他假设更不现实。特别是，您可能会感到困扰的是每个作业的运行时间都是已知的：这将使调度程序无所不知，尽管这将是伟大的（可能），但不太可能在短时间内发生。</p><h2 id="_7-2-调度指标" tabindex="-1"><a class="header-anchor" href="#_7-2-调度指标" aria-hidden="true">#</a> 7.2 调度指标</h2>',14),y=s("p",null,[a("除了做出工作负载假设外，我们还需要一件东西来使我们能够比较不同的调度策略：调度指标。指标只是我们用来衡量某些东西的东西，而在调度中有许多不同的指标是有意义的。然而，暂时让我们简化生活，只使用一个指标：周转时间。作业的周转时间被定义为作业完成的时间减去作业到达系统的时间。更正式地说，周转时间"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"t"),s("mi",null,"u"),s("mi",null,"r"),s("mi",null,"n"),s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"d")])])]),s("annotation",{encoding:"application/x-tex"},"T_{turnaround}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathnormal mtight"},"na"),s("span",{class:"mord mathnormal mtight"},"ro"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight"},"d")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a("如下：")],-1),v=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"t"),s("mi",null,"u"),s("mi",null,"r"),s("mi",null,"n"),s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"d")])]),s("mo",null,"="),s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"m"),s("mi",null,"p"),s("mi",null,"l"),s("mi",null,"e"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"o"),s("mi",null,"n")])]),s("mo",null,"−"),s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"r"),s("mi",null,"i"),s("mi",null,"v"),s("mi",null,"a"),s("mi",null,"l")])])]),s("annotation",{encoding:"application/x-tex"}," T_{turnaround} = T_{completion} − T_{arrival} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathnormal mtight"},"na"),s("span",{class:"mord mathnormal mtight"},"ro"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight"},"d")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"co"),s("span",{class:"mord mathnormal mtight"},"m"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.01968em"}},"pl"),s("span",{class:"mord mathnormal mtight"},"e"),s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight"},"o"),s("span",{class:"mord mathnormal mtight"},"n")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"rr"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.01968em"}},"l")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])])])],-1),_=s("p",null,[a("因为我们假设所有作业都在同一时间到达，所以目前 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"r"),s("mi",null,"i"),s("mi",null,"v"),s("mi",null,"a"),s("mi",null,"l")])]),s("mo",null,"="),s("mn",null,"0")]),s("annotation",{encoding:"application/x-tex"},"T_{arrival} = 0")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"rr"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.01968em"}},"l")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0")])])]),a("，因此"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"t"),s("mi",null,"u"),s("mi",null,"r"),s("mi",null,"n"),s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"d")])]),s("mo",null,"="),s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"m"),s("mi",null,"p"),s("mi",null,"l"),s("mi",null,"e"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"o"),s("mi",null,"n")])])]),s("annotation",{encoding:"application/x-tex"},"T_{turnaround} = T_{completion}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathnormal mtight"},"na"),s("span",{class:"mord mathnormal mtight"},"ro"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight"},"d")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"co"),s("span",{class:"mord mathnormal mtight"},"m"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.01968em"}},"pl"),s("span",{class:"mord mathnormal mtight"},"e"),s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight"},"o"),s("span",{class:"mord mathnormal mtight"},"n")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])])])])]),a("。随着我们放宽前述的假设，这个事实将发生改变。")],-1),b=s("p",null,"您应该注意，周转时间是一种性能指标，它将是本章的主要关注点。另一个感兴趣的指标是公平性，可以通过Jain公平性指数[J91]等来衡量。性能和公平性在调度中经常相互矛盾；例如，调度程序可能优化性能，但以阻止一些作业运行为代价，从而降低公平性。这个困境告诉我们，生活并不总是完美的。",-1),x=s("h2",{id:"_7-3-先进先出-fifo",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_7-3-先进先出-fifo","aria-hidden":"true"},"#"),a(" 7.3 先进先出（FIFO）")],-1),f=s("p",null,"我们可以实现的最基本的调度算法之一被称为先进先出（FIFO）调度，有时也称为先来先服务（FCFS）。FIFO具有许多积极的特性：它显然很简单，因此易于实现。并且，在我们的假设下，它工作得相当不错。",-1),w=s("p",null,"让我们一起快速举个例子。想象一下，系统中有三个作业，A、B和C，它们几乎在同一时间到达（Tarrival = 0）。因为FIFO必须首先放置某个作业，让我们假设虽然它们都是同时到达的，A比B稍微早到一点，B比C稍微早到一点。还假设每个作业运行10秒。这些作业的平均周转时间将是多少？",-1),z=s("figure",null,[s("img",{src:p,alt:"FIFO Simple example",tabindex:"0",loading:"lazy"}),s("figcaption",null,"图 7.1 简单的 FIFO 例子")],-1),F=s("p",null,[a("从图 7.1 中，您可以看到 A 在 10 时完成，B 在 20 时完成，C 在 30 时完成。因此，这三个作业的平均周转时间简单地是 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mn",null,"10"),s("mo",null,"+"),s("mn",null,"20"),s("mo",null,"+"),s("mn",null,"30")]),s("mn",null,"3")]),s("mo",null,"="),s("mn",null,"20")]),s("annotation",{encoding:"application/x-tex"},"\\frac{10 + 20 + 30}{3} = 20")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1901em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8451em"}},[s("span",{style:{top:"-2.655em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"3")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"10"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"20"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"30")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"20")])])]),a("。计算周转时间就是这么简单。")],-1),T=s("p",null,"现在让我们放宽我们的一个假设。特别是，让我们放宽假设1，因此不再假设每个作业运行的时间相同。FIFO现在的表现如何？您能构建什么样的工作负载来使FIFO的性能变差？",-1),k=s("p",null,[s("em",null,"（在阅读以下内容之前，请考虑一下...继续思考...搞清楚了吗？！）")],-1),S=s("p",null,"您现在可能已经弄清楚了，但以防万一，让我们再举一个示例，以展示不同长度的作业怎么让 FIFO 调度出现问题。特别是，让我们再次假设有三个作业（A、B和C），但这次A运行100秒，而B和C各自运行10秒。",-1),C=s("figure",null,[s("img",{src:c,alt:"Why FIFO Is Not That Great",tabindex:"0",loading:"lazy"}),s("figcaption",null,"图 7.2 为什么 FIFO 并不那么好")],-1),M=s("p",null,[a("如您在图 7.2 中所见，作业A在B或C甚至有机会运行之前，首先运行了整整 100 s。因此，系统的平均周转时间很高：110 s（"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mn",null,"100"),s("mo",null,"+"),s("mn",null,"110"),s("mo",null,"+"),s("mn",null,"120")]),s("mn",null,"3")]),s("mo",null,"="),s("mn",null,"110")]),s("annotation",{encoding:"application/x-tex"},"\\frac{100 + 110 + 120}{3} = 110")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1901em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8451em"}},[s("span",{style:{top:"-2.655em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"3")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"100"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"110"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"120")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"110")])])]),a("）。")],-1),J=s("p",null,"这个问题通常被称为护航效应（convey effect），其中一些相对较短的潜在资源使用者排在一个重量级资源使用者后面。这种调度情景可能让你想起杂货店里的一个排队等待的场景，当你看到前面的人推着三车食品并拿出支票簿时，你知道要等一段时间。",-1),A=s("p",null,"那么我们该怎么办呢？如何开发一个更好的算法来处理运行时间不同的作业？先自己思考一下，然后再阅读下文。",-1),B=s("h2",{id:"_7-4-最短任务优先-sjf",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_7-4-最短任务优先-sjf","aria-hidden":"true"},"#"),a(" 7.4 最短任务优先（SJF）")],-1),I=s("p",null,"解决这个问题的方法非常简单，事实上是从运筹学[1954 年的参考文献，1956 年的参考文献]中借鉴过来的，应用到了计算机系统中的作业调度。这个新的调度策略被称为“最短作业优先”（Shortest Job First，SJF），这个名字应该很容易记住，因为它完全描述了这个策略：首先运行最短的作业，然后是下一个最短的，以此类推。",-1),O={class:"hint-container tip"},L=s("p",{class:"hint-container-title"},"SJF 调度算法的原则",-1),E={href:"https://zh.wikipedia.org/zh-cn/%E6%A0%B8%E5%86%AC%E5%A4%A9",target:"_blank",rel:"noopener noreferrer"},N=s("figure",null,[s("img",{src:h,alt:"image-20231021205801817",tabindex:"0",loading:"lazy"}),s("figcaption",null,"7.3 简单的 SJF 例子")],-1),V=s("p",null,[a("让我们继续使用上面的示例，但将SJF作为我们的调度策略。图7.3显示了运行A、B和C的结果。希望这个图表清楚地表明了为什么SJF在平均周转时间方面表现得更好。通过在运行A之前先运行B和C，SJF将平均周转时间从110秒减少到50秒（"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mn",null,"10"),s("mo",null,"+"),s("mn",null,"20"),s("mo",null,"+"),s("mn",null,"120")]),s("mn",null,"3")]),s("mo",null,"="),s("mn",null,"50")]),s("annotation",{encoding:"application/x-tex"},"\\frac{10 + 20 + 120}{3} = 50")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1901em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8451em"}},[s("span",{style:{top:"-2.655em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"3")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"10"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"20"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mord mtight"},"120")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"50")])])]),a("），性能提高了两倍多。")],-1),P=s("p",null,"事实上，根据我们关于所有作业同时到达的假设，我们可以证明 SJF 确实是一种最优的调度算法。然而，您正在上系统课程，而不是理论或运筹学课程；所以在这里就不给出它的证明。",-1),j=s("p",null,"因此，我们已经找到了一个很好的SJF调度方法，但我们的假设仍然相当不现实。让我们放宽一些。具体来说，我们可以针对假设2，现在假设作业可以在任何时间到达，而不是一次性到达。这会导致什么问题呢？ （再次思考...你在思考吗？）",-1),R=s("p",null,"在这里，我们可以通过一个示例再次说明问题。这一次，假设 A 在 t = 0 时到达，需要运行100 秒，而 B 和 C 在 t = 10 时到达，每个都需要运行10秒。使用纯 SJF，我们将得到图 7.4中所示的时间表。",-1),U=s("figure",null,[s("img",{src:o,alt:"SJF Example With Late Arrivals From B and C",tabindex:"0",loading:"lazy"}),s("figcaption",null,"图 7.4 SJF 例子：晚到的作业 B 和 C")],-1),W=s("p",null,[a("如图 7.4 所示，尽管 B 和 C 在 A 之后不久到达，但它们仍然被迫等待 A 完成，因此遭受了相同的车队问题。这三个作业的平均周转时间为 103.33 秒（"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mn",null,"100"),s("mo",null,"+"),s("mo",{stretchy:"false"},"("),s("mn",null,"110"),s("mo",null,"−"),s("mn",null,"10"),s("mo",{stretchy:"false"},")"),s("mo",null,"+"),s("mo",{stretchy:"false"},"("),s("mn",null,"120"),s("mo",null,"−"),s("mn",null,"10"),s("mo",{stretchy:"false"},")")]),s("mn",null,"3")]),s("mo",null,"="),s("mn",null,"103.33")]),s("annotation",{encoding:"application/x-tex"},"\\frac{100 + (110-10) + (120-10)}{3} = 103.33")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.355em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.01em"}},[s("span",{style:{top:"-2.655em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"3")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.485em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"100"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mopen mtight"},"("),s("span",{class:"mord mtight"},"110"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"10"),s("span",{class:"mclose mtight"},")"),s("span",{class:"mbin mtight"},"+"),s("span",{class:"mopen mtight"},"("),s("span",{class:"mord mtight"},"120"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"10"),s("span",{class:"mclose mtight"},")")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"103.33")])])]),a("）。调度程序可以采取什么措施呢？")],-1),G=l('<h2 id="_7-5-最短完成时间优先-stcf" tabindex="-1"><a class="header-anchor" href="#_7-5-最短完成时间优先-stcf" aria-hidden="true">#</a> 7.5 最短完成时间优先（STCF）</h2><p>为解决这个问题，我们需要放宽第3个假设（即作业必须运行到完成），因此让我们这样做。此外，调度程序本身需要一些机制。如您可能猜到的，考虑到我们之前关于定时器中断和上下文切换的讨论，调度程序可以在 B 和 C 到达时采取其他措施：它可以抢占作业A，并决定运行另一个作业，或许稍后继续 A。根据我们的定义，SJF 是一个非抢占式调度程序，因此存在上述问题。</p><figure><img src="'+g+'" alt="STCF Simple Example" tabindex="0" loading="lazy"><figcaption><b>图 7.2</b> 简单的 STCF 例子</figcaption></figure><p>幸运的是，有一个调度程序可以做到这一点：为SJF添加抢占功能，即最短剩余运行时间优先（STCF）或抢占式最短作业优先（PSJF）调度程序[CK68]。每当新作业进入系统时，STCF调度程序确定剩余作业（包括新作业）中哪个作业剩余时间最少，并安排运行该作业。因此，在我们的示例中，STCF将抢占A并运行B和C直到完成；只有在它们完成后，才会安排A的剩余时间。图7.5显示了一个示例。</p><p>结果是平均周转时间大大提高：50秒（（120−0）+（20−10）+（30−10）3）。与以前一样，根据我们的新假设，STCF 是可证明的最优的；考虑到如果所有作业同时到达，则SJF是最优的，您可能能够理解 STCF 最优性背后的直觉。</p><h2 id="_7-6-新度量指标-响应时间" tabindex="-1"><a class="header-anchor" href="#_7-6-新度量指标-响应时间" aria-hidden="true">#</a> 7.6 新度量指标：响应时间</h2><p>因此，如果我们知道作业的长度，且作业只使用CPU，而我们唯一的指标是周转时间，那么STCF将是一个很好的策略。实际上，对于早期的批处理计算系统，这些类型的调度算法是有道理的。然而，分时共享计算机的引入改变了一切。现在，用户会坐在终端前，要求系统具有交互性能。因此，产生了一个新的度量标准：响应时间。</p><p>我们将响应时间定义为作业到达系统后首次被调度的时间。更正式地说：</p>',8),K=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"r"),s("mi",null,"e"),s("mi",null,"s"),s("mi",null,"p"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"s"),s("mi",null,"e")])]),s("mo",null,"="),s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"f"),s("mi",null,"i"),s("mi",null,"r"),s("mi",null,"s"),s("mi",null,"t"),s("mi",null,"r"),s("mi",null,"u"),s("mi",null,"n")])]),s("mo",null,"−"),s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"a"),s("mi",null,"r"),s("mi",null,"r"),s("mi",null,"i"),s("mi",null,"v"),s("mi",null,"a"),s("mi",null,"l")])])]),s("annotation",{encoding:"application/x-tex"}," T_{response} = T_{firstrun} − T_{arrival} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1514em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"res"),s("span",{class:"mord mathnormal mtight"},"p"),s("span",{class:"mord mathnormal mtight"},"o"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight"},"se")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10764em"}},"f"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight"},"rs"),s("span",{class:"mord mathnormal mtight"},"t"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathnormal mtight"},"u"),s("span",{class:"mord mathnormal mtight"},"n")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"rr"),s("span",{class:"mord mathnormal mtight"},"i"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"mord mathnormal mtight"},"a"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.01968em"}},"l")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])])])],-1),X=l('<h2 id="_7-7-时间片轮转调度" tabindex="-1"><a class="header-anchor" href="#_7-7-时间片轮转调度" aria-hidden="true">#</a> 7.7 时间片轮转调度</h2><h2 id="_7-8-结合-i-o" tabindex="-1"><a class="header-anchor" href="#_7-8-结合-i-o" aria-hidden="true">#</a> 7.8 结合 I/O</h2><h2 id="_7-9-no-more-oracle" tabindex="-1"><a class="header-anchor" href="#_7-9-no-more-oracle" aria-hidden="true">#</a> 7.9 No More Oracle</h2><p>有了基本的I/O方法，我们来到了最后一个假设：调度程序知道每个作业的长度。正如我们之前所说，这可能是我们能够做出的最糟糕的假设。事实上，在通用操作系统（我们关心的那种）中，操作系统通常对每个作业的长度知之甚少。那么，如何构建一个行为类似SJF/STCF的方法，而不需要这样的先验知识？此外，如何结合我们在RR调度程序中看到的一些想法，使响应时间也非常好？</p><h2 id="_7-10-小结" tabindex="-1"><a class="header-anchor" href="#_7-10-小结" aria-hidden="true">#</a> 7.10 小结</h2>',5);function Y(Z,$){const t=r("ExternalLinkIcon");return m(),i("div",null,[d,y,v,_,b,x,f,w,z,F,T,k,S,C,M,J,A,B,I,s("div",O,[L,s("p",null,[a("SJF原则表示了一个通用的调度原则，可以应用于任何关心每个客户（或在我们的情况下，作业）的周转时间的系统。想象一下你等过的任何队列：如果相关的机构关心客户满意度，他们很可能已经考虑了SJF。例如，杂货店通常设有一个“十件或以下”的队伍，以确保只购买少量商品的顾客不会被堵在准备应对未来"),s("a",E,[a("核冬天"),e(t)]),a("的家庭后面。")])]),N,V,P,j,R,U,W,G,K,X])}const D=n(u,[["render",Y],["__file","cpu-sched.html.vue"]]);export{D as default};
